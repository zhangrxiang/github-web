<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags always come first -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.css">
    <style>
        .time {
            margin: 0 5px
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- <h1 class="text-info">Learn English
            <span id="count" class="text-success time"></span>
        </h1> -->
        <h6>Now:
            <i id="time"></i>
        </h6>
        <h6>
            <span class="text-success g_d"></span>
            <span class="time">days</span>
            <span class="text-primary g_h"></span>
            <span class="time">hours</span>
            <span class="text-info g_m"></span>
            <span class="time">minutes</span>
            <span class="text-danger g_s"></span>
            <span class="time">seconds</span> of annual leave distance</h6>
        <h6>
            <span class="text-success s_d"></span>
            <span class="time">days</span>
            <span class="text-primary s_h"></span>
            <span class="time">hours</span>
            <span class="text-info s_m"></span>
            <span class="time">minutes</span>
            <span class="text-danger s_s"></span>
            <span class="time">seconds</span> of the Spring Festival distance</h6>
        <div id="accordion">
            <div hidden class="card">
                <div class="card-header">
                    <h5 class="mb-0">
                        <a role="button" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                            Interpreter
                        </a>
                    </h5>
                </div>
                <div id="collapseOne" class="collapse in">
                    <div class="card-block">
                        Interpreter
                    </div>
                </div>
            </div>
        </div>
        <ul class="pagination">
        </ul>
    </div>
    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="js/data.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/dist/util.js"></script>
    <script src="js/dist/collapse.js"></script>
    <script type="text/javascript">
        $(function () {
            setInterval(function () {
                var now = new Date();
                var sprint = new Date(2018, 1, 15, 0, 0, 0);
                var holiday = new Date(2017, 0, 23, 0, 0, 0);
                $("#time").html(now);

                var t = sprint.getTime() - now.getTime();
                var d = 0;
                var h = 0;
                var m = 0;
                var s = 0;
                if (t >= 0) {
                    d = Math.floor(t / 1000 / 60 / 60 / 24);
                    h = Math.floor(t / 1000 / 60 / 60 % 24);
                    m = Math.floor(t / 1000 / 60 % 60);
                    s = Math.floor(t / 1000 % 60);
                }
                $(".s_d").html(d);
                $(".s_h").html(h);
                $(".s_m").html(m);
                $(".s_s").html(s);
                t = holiday.getTime() - now.getTime();
                if (t >= 0) {
                    d = Math.floor(t / 1000 / 60 / 60 / 24);
                    h = Math.floor(t / 1000 / 60 / 60 % 24);
                    m = Math.floor(t / 1000 / 60 % 60);
                    s = Math.floor(t / 1000 % 60);
                }
                $(".g_d").html(d);
                $(".g_h").html(h);
                $(".g_m").html(m);
                $(".g_s").html(s);

            }, 1000);
            var location = getLocation();
            console.log(location);
            var href = location[0];
            var p = location[1];
            if (p === undefined) {
                p = "&value=1";
            }
            console.log(p);
            var max = 10;
            try {
                if (window.localStorage) {
                    var local = window.localStorage;
                    local.clear();
                    put(local, data);
                    var length = local.length;
                    $("#count").text(length);
                    var size = Math.ceil(length / 10);
                    var pagination = "";
                    var active = "";
                    var page = p.split("=")[1];
                    for (var s = 0; s < size; s++) {
                        if ((s + 1) == page) active = "active ";
                        else active = "";
                        pagination +=
                            '<li class="' + active + 'page-item"><a class="page-link" href="' + href + "&value=" + (s + 1) + '">' + (s + 1) + ' <span class="sr-only">(current)</span></a></li>'
                    }
                    $(".pagination").append(pagination);
                    //                console.log(size);
                    var html = get(local, page, max);
                    $('#accordion').append(html);
                } else {
                    alert("no support localStorage!!!!")
                }
            } catch (e) {
                alert('出错了');
                throw new Error(10, e);
            }

        });

        function put(local, data) {
            var index = 1;
            for (var i in data) {
                local.setItem((index++).toString(), i + "##" + data[i]);
            }
        }
        function get(local, page, max) {
            var html = '';
            console.log("page " + page);
            for (var j = (page - 1) * 10 + 1; j < page * 10 + 1; j++) {
                var index = local.key(j.toString());
                //            console.log("index "+j.toString());
                if (index != null) {
                    var item = local.getItem(index);
                    //                console.log(item);
                    var k = item.split("##")[0];
                    var v = item.split("##")[1];
                    html +=
                        '<div class="card">' +
                        '<div class="card-header">' +
                        '<h5 class="mb-0">' +
                        '<i>' + index + '</i> <a style="display: inline-block;width: 90%;" role="button" data-toggle="collapse" data-parent="#accordion" href="#' + k + '">' + k +
                        '</a>' +
                        '</h5>' +
                        '</div>' +
                        '<div id=' + k + ' class="collapse">' +
                        '<div class="card-block">' + v +
                        '</div>' +
                        '</div>' +
                        '</div>';
                }
            }
            return html;
        }

        function getLocation() {
            var url = document.location.href;
            if (url[url.lastIndexOf("/") + 1] != "?")
                url += "?";
            url = url.split("&");
            return url;
        }
    </script>
</body>

</html>